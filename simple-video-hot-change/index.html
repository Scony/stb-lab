<html>
  <head>
    <script src="https://code.jquery.com/jquery-1.12.4.js"></script>
  </head>
  <body bgcolor="#ff9900">
    <br><br><br>
    <div style="position:relative;left:100px">
      <video controls="" width="480" controls>
        <source src="https://interactive-examples.mdn.mozilla.net/media/cc0-videos/flower.mp4" type="video/mp4">
        Sorry, your browser doesn't support embedded videos.
      </video>
    </div>
    <script>
      function findGetParameter(parameterName) {
          var result = null,
              tmp = [];
          location.search
              .substr(1)
              .split("&")
              .forEach(function (item) {
                  tmp = item.split("=");
                  if (tmp[0] === parameterName) result = decodeURIComponent(tmp[1]);
              });
          return result;
      }

      function b64_to_utf8(str) {
          return decodeURIComponent(escape(window.atob( str )));
      }

      function change_video_after_3s(_) {
          if ($("video")[0].currentTime >= 3.0) {
              console.log('change')
              $("video")[0].removeEventListener('timeupdate', change_video_after_3s);
              var video_src = findGetParameter("video_src");
              var video_type = findGetParameter("video_type");
              var seek_target = findGetParameter("seek_target");
              seek_target = seek_target == null ? 4.0 : seek_target;
              if (video_src != null && video_type != null) {
                  video_src = b64_to_utf8(video_src);
                  $("source")[0].src = video_src;
                  $("source")[0].type = video_type;
                  $("video")[0].addEventListener('loadeddata', function(_) {
                      $("video")[0].currentTime = seek_target;
                      $("video")[0].play();
                  }, {once:true});
                  $("video")[0].load();
              }
          }
      }

      $(document).ready(function() {
          $("video")[0].addEventListener('loadeddata', function(_) {
              $("video")[0].play();
          }, {once:true});
          $("video")[0].addEventListener('timeupdate', change_video_after_3s);
          $("video")[0].load();
      });
    </script>
  </body>
</html>
